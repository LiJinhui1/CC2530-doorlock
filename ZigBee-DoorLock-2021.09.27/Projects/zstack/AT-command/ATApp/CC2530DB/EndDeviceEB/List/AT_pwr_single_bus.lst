###############################################################################
#
# IAR C/C++ Compiler V10.30.1.6000 for 8051               30/Nov/2021  19:12:52
# Copyright 2004-2018 IAR Systems AB.
# PC-locked license - IAR Embedded Workbench for 8051
#
#    Core               =  plain
#    Code model         =  banked
#    Data model         =  large
#    Calling convention =  xdata reentrant
#    Constant location  =  data_rom
#    Dptr setup         =  1,16
#                          
#    Source file        =  
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\Source\Controller\AT_pwr_single_bus.c
#    Command line       =  
#        -f C:\Users\ADMINI~1\AppData\Local\Temp\EW5D2B.tmp
#        (F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\Source\Controller\AT_pwr_single_bus.c
#        -D WDT_IN_PM1 -D ZIGBEEPRO -D INTER_PAN -D ZIGBEE_FREQ_AGILITY -D
#        DISABLE_GREENPOWER_BASIC_PROXY -D REFLECTOR -D HAL_UART=FALSE -D
#        HAL_LED=FALSE -D HAL_KEY=FALSE -D SECURE=1 -D TC_LINKKEY_JOIN -D
#        NV_INIT -D NV_RESTORE -D POWER_SAVING -D NWK_AUTO_POLL -D xZTOOL_P1 -D
#        xMT_TASK -D xMT_APP_FUNC -D xMT_SYS_FUNC -D xMT_ZDO_FUNC -D
#        xMT_ZDO_MGMT -D xMT_APP_CNF_FUNC -D xLEGACY_LCD_DEBUG -D
#        xLCD_SUPPORTED=DEBUG -D MULTICAST_ENABLED=FALSE -D ZCL_READ -D
#        ZCL_WRITE -D ZCL_DISCOVER -D ZCL_BASIC -D ZCL_IDENTIFY -D ZCL_SCENES
#        -D ZCL_GROUPS -D BDB_REPORTING -D ZCL_DOORLOCK -D ZCL_DOORLOCK_EXT -D
#        ISR_KEYINTERRUPT -lC
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\EndDeviceEB\List
#        -lA
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\EndDeviceEB\List
#        --diag_suppress Pe001,Pa010 -o
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\EndDeviceEB\Obj
#        -e --debug --core=plain --dptr=16,1 --data_model=large
#        --code_model=banked --calling_convention=xdata_reentrant
#        --place_constants=data_rom --nr_virtual_regs 16 -f
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wEndev.cfg
#        (-DCPU32MHZ -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3
#        -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wConfig.cfg
#        (-DZIGBEEPRO -DSECURE=1 -DZG_SECURE_DYNAMIC=0 -DREFLECTOR
#        -DDEFAULT_CHANLIST=0x00000800 -DZDAPP_CONFIG_PAN_ID=0xFFFF
#        -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MASK=0x007F
#        -DBEACON_REQUEST_DELAY=100 -DBEACON_REQ_DELAY_MASK=0x00FF
#        -DLINK_STATUS_JITTER_MASK=0x007F -DROUTE_EXPIRY_TIME=30
#        -DAPSC_ACK_WAIT_DURATION_POLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7
#        -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3
#        -DNWK_MAX_DATA_RETRIES=2 -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9
#        -DAPS_MAX_GROUPS=10 -DMAX_RTG_ENTRIES=15 -DNWK_MAX_BINDING_ENTRIES=4
#        -DMAX_BINDING_CLUSTER_IDS=4 -DDEFAULT_KEY={0} -DMAC_MAX_FRAME_SIZE=116
#        -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const __code"
#        -DGENERIC=__generic -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=300
#        -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100 -DREJOIN_POLL_RATE=440
#        -DREJOIN_BACKOFF=900000 -DREJOIN_SCAN=900000) -f
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\Tools\CC2530DB\f8wZCL.cfg
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\Source\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\Source\ZCL\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\Source\UserAPI\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\Source\Controller\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\ZMain\TI2530DB\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\hal\include\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\hal\target\CC2530EB\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\mac\include\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\mac\high_level\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\mac\low_level\srf04\single_chip\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\mt\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\osal\include\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\services\saddr\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\services\sdata\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\af\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\bdb\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\gp\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\nwk\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\sapi\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\sec\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\sys\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\zcl\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\stack\zdo\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\zmac\
#        -I
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\..\..\..\..\..\Components\zmac\f8w\
#        -Ohz --require_prototypes)
#    Locale             =  Chinese (Simplified)_CHN.936
#    List file          =  
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\EndDeviceEB\List\AT_pwr_single_bus.lst
#    Object file        =  
#        F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\CC2530DB\EndDeviceEB\Obj\AT_pwr_single_bus.r51
#
###############################################################################

F:\2workspace\doorlock-CC2530\ZigBee-DoorLock-2021.09.27\Projects\zstack\AT-command\ATApp\Source\Controller\AT_pwr_single_bus.c
      1          /******************************************************************************
      2            Filename:       AT_single_bus.c
      3            Author:         Yang Wang
      4          ******************************************************************************/
      5          #include "AT_pwr_single_bus.h"

   \                                 In  segment SFR_AN, at 0x8b
   \   unsigned char volatile __sfr P2IFG
   \                     P2IFG:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x8c
   \   unsigned char volatile __sfr PICTL
   \                     PICTL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0x9a
   \   unsigned char volatile __sfr IEN2
   \                     IEN2:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xa0
   \   union <unnamed> volatile __sfr _A_P2
   \                     _A_P2:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xa8
   \   union <unnamed> volatile __sfr _A_IEN0
   \                     _A_IEN0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xa9
   \   unsigned char volatile __sfr IP0
   \                     IP0:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xac
   \   unsigned char volatile __sfr P2IEN
   \                     P2IEN:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xb9
   \   unsigned char volatile __sfr IP1
   \                     IP1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc0
   \   union <unnamed> volatile __sfr _A_IRCON
   \                     _A_IRCON:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xc9
   \   unsigned char volatile __sfr WDCTL
   \                     WDCTL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xe8
   \   union <unnamed> volatile __sfr _A_IRCON2
   \                     _A_IRCON2:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf5
   \   unsigned char volatile __sfr P2SEL
   \                     P2SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf7
   \   unsigned char volatile __sfr P2INP
   \                     P2INP:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xff
   \   unsigned char volatile __sfr P2DIR
   \                     P2DIR:
   \   000000                DS 1
      6          #include "AT_doorlock.h"
      7          #include "AT_timer4.h"
      8          #include "zcl_doorlock.h"
      9          #include "OnBoard.h"
     10          #include "AT_printf.h"
     11          #include "bdb.h"
     12          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     13          uint8 pwr_single_bus_rcv_buf[PWR_SINGLE_BUS_RCV_MAX] = {0x00};
   \                     pwr_single_bus_rcv_buf:
   \   000000                DS 10
   \   00000A                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     14          uint8 pwr_single_bus_rcv_len = 0;
   \                     pwr_single_bus_rcv_len:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     15          uint8 pwr_single_bus_rcv_bit = 0;
   \                     pwr_single_bus_rcv_bit:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     16          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     17          uint16 pwr_single_bus_rcv_total = 0;
   \                     pwr_single_bus_rcv_total:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     18          uint16 pwr_single_bus_rcv_high = 0;
   \                     pwr_single_bus_rcv_high:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     19          uint16 pwr_single_bus_rcv_low = 0;
   \                     pwr_single_bus_rcv_low:
   \   000000                DS 2
   \   000002                REQUIRE __INIT_XDATA_Z
     20          
     21          static void AT_pwr_single_bus_input(void);
     22          static void AT_pwr_single_bus_output(void);
     23          static void AT_pwr_single_bus_send_byte(uint8 dataByte);
     24          static void pwr_senddata(uint8* buf);
     25          

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     26          static void AT_pwr_single_bus_input(void)
   \                     AT_pwr_single_bus_input:
     27          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
     28            PWR_SINGLE_BUS_SEL &= ~PWR_SINGLE_BUS_BV;
   \   000000   53F5FE       ANL       0xf5,#0xfe
     29            PWR_SINGLE_BUS_DIR &= ~PWR_SINGLE_BUS_BV;
   \   000003   53FFFE       ANL       0xff,#0xfe
     30            PWR_SINGLE_BUS_INP &= ~PWR_SINGLE_BUS_BV;
   \   000006   53F7FE       ANL       0xf7,#0xfe
     31          
     32            P2IFG = 0x00;
   \   000009   758B00       MOV       0x8b,#0x0
     33            P2IF  = 0x00;
   \   00000C   C2E8         CLR       0xe8.0
     34          
     35            IEN2  |= BV(1); // enable port interrupt
   \   00000E   439A02       ORL       0x9a,#0x2
     36            P2IEN |= PWR_SINGLE_BUS_BV; // enable pin interrupt
   \   000011   43AC01       ORL       0xac,#0x1
     37          
     38            P2INP &= ~BV(7); // pull up
   \   000014   53F77F       ANL       0xf7,#0x7f
     39            PICTL |=  PWR_SINGLE_BUS_EDGE_BV; // falling edge
   \   000017   438C08       ORL       0x8c,#0x8
     40          }
   \   00001A   02....       LJMP      ?BRET
   \   00001D                REQUIRE P2SEL
   \   00001D                REQUIRE P2DIR
   \   00001D                REQUIRE P2INP
   \   00001D                REQUIRE P2IFG
   \   00001D                REQUIRE _A_IRCON2
   \   00001D                REQUIRE IEN2
   \   00001D                REQUIRE P2IEN
   \   00001D                REQUIRE PICTL
     41          static void AT_pwr_single_bus_output(void)
     42          {
     43            PWR_SINGLE_BUS_SEL &= ~PWR_SINGLE_BUS_BV;
     44            PWR_SINGLE_BUS_DIR |=  PWR_SINGLE_BUS_BV;
     45          
     46            IEN2  &= ~BV(1); // disable port interrupt
     47            P2IEN &= ~PWR_SINGLE_BUS_BV; // disable pin interrupt
     48          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     49          void AT_pwr_single_bus_init(void)
   \                     AT_pwr_single_bus_init:
     50          {
   \   000000   C082         PUSH      DPL
   \   000002   C083         PUSH      DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
     51            AT_pwr_single_bus_input();
   \   000004                ; Setup parameters for call to function AT_pwr_single_bus_input
   \   000004   12....       LCALL     `??AT_pwr_single_bus_input::?relay`; Banked call to: AT_pwr_single_bus_input
     52          
     53            // set IPG1(ADC/P1/P2INT) to the highest priority
     54            IP1 = 0x12;         //interrupt priority
   \   000007   75B912       MOV       0xb9,#0x12
     55            IP0 = 0x10;
   \   00000A   75A910       MOV       0xa9,#0x10
     56          }
   \   00000D   D083         POP       DPH
   \   00000F   D082         POP       DPL
   \   000011   02....       LJMP      ?BRET
   \   000014                REQUIRE IP1
   \   000014                REQUIRE IP0
     57          static void AT_pwr_single_bus_send_byte(uint8 dataByte)
     58          {
     59            uint8 i;
     60          
     61            for(i=0; i<8; i++)
     62            {
     63              if(dataByte & 0x01)
     64              {
     65                PWR_SINGLE_BUS_PIN = PWR_SINGLE_BUS_HIGH;
     66                MicroWait(191); // more close to 160 us
     67          
     68                PWR_SINGLE_BUS_PIN = PWR_SINGLE_BUS_LOW;
     69                MicroWait(92); // more close to 80 us
     70              }
     71              else
     72              {
     73                PWR_SINGLE_BUS_PIN = PWR_SINGLE_BUS_HIGH;
     74                MicroWait(92); // more close to 80 us
     75          
     76                PWR_SINGLE_BUS_PIN = PWR_SINGLE_BUS_LOW;
     77                MicroWait(191); // more close to 160 us
     78              }
     79          
     80              dataByte >>= 1;
     81            }
     82          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     83          void AT_pwr_single_bus_send_buf(uint8 *buf, uint8 len)
   \                     AT_pwr_single_bus_send_buf:
     84          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000   74F2         MOV       A,#-0xe
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   EA           MOV       A,R2
   \   000006   FE           MOV       R6,A
   \   000007   EB           MOV       A,R3
   \   000008   FF           MOV       R7,A
   \   000009   89..         MOV       ?V3,R1
     85            uint8 i;
     86          
     87            printf("|down|-----|%02d bytes|: ", len);
   \   00000B                ; Setup parameters for call to function printf
   \   00000B   E9           MOV       A,R1
   \   00000C   F5..         MOV       ?V0,A
   \   00000E   75..00       MOV       ?V1,#0x0
   \   000011   78..         MOV       R0,#?V0
   \   000013   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000016   7A..         MOV       R2,#`?<Constant "|down|-----|%02d byte...">` & 0xff
   \   000018   7B..         MOV       R3,#(`?<Constant "|down|-----|%02d byte...">` >> 8) & 0xff
   \   00001A   12....       LCALL     `??printf::?relay`; Banked call to: printf
   \   00001D   7402         MOV       A,#0x2
   \   00001F   12....       LCALL     ?DEALLOC_XSTACK8
     88            for(i=0; i<len; i++)
   \   000022   75..00       MOV       ?V0,#0x0
   \   000025   801B         SJMP      ??AT_pwr_single_bus_send_buf_0
     89            {
     90              printf("%02X ", buf[i]);
   \                     ??AT_pwr_single_bus_send_buf_1:
   \   000027                ; Setup parameters for call to function printf
   \   000027   12....       LCALL     ?Subroutine0 & 0xFFFF
     91            }
   \                     ??CrossCallReturnLabel_0:
   \   00002A   F5..         MOV       ?V4,A
   \   00002C   75..00       MOV       ?V5,#0x0
   \   00002F   78..         MOV       R0,#?V4
   \   000031   12....       LCALL     ?PUSH_XSTACK_I_TWO
   \   000034   7A..         MOV       R2,#`?<Constant "%02X ">` & 0xff
   \   000036   7B..         MOV       R3,#(`?<Constant "%02X ">` >> 8) & 0xff
   \   000038   12....       LCALL     `??printf::?relay`; Banked call to: printf
   \   00003B   7402         MOV       A,#0x2
   \   00003D   12....       LCALL     ?DEALLOC_XSTACK8
   \   000040   05..         INC       ?V0
   \                     ??AT_pwr_single_bus_send_buf_0:
   \   000042   E5..         MOV       A,?V0
   \   000044   C3           CLR       C
   \   000045   95..         SUBB      A,?V3
   \   000047   40DE         JC        ??AT_pwr_single_bus_send_buf_1
     92            printf("\r\n");
   \   000049                ; Setup parameters for call to function printf
   \   000049   7A..         MOV       R2,#`?<Constant "\\r\\n">` & 0xff
   \   00004B   7B..         MOV       R3,#(`?<Constant "\\r\\n">` >> 8) & 0xff
   \   00004D   12....       LCALL     `??printf::?relay`; Banked call to: printf
     93          
     94            AT_pwr_single_bus_output();
   \   000050   53F5FE       ANL       0xf5,#0xfe
   \   000053   43FF01       ORL       0xff,#0x1
   \   000056   539AFD       ANL       0x9a,#0xfd
   \   000059   53ACFE       ANL       0xac,#0xfe
     95          
     96            PWR_SINGLE_BUS_PIN = PWR_SINGLE_BUS_LOW;
   \   00005C   C2A0         CLR       0xa0.0
     97            MicroWait(4900); // more close to 4 ms
   \   00005E                ; Setup parameters for call to function Onboard_wait
   \   00005E   7A24         MOV       R2,#0x24
   \   000060   7B13         MOV       R3,#0x13
   \   000062   12....       LCALL     `??Onboard_wait::?relay`; Banked call to: Onboard_wait
     98          
     99            for(i=0; i<len; i++)
   \   000065   75..00       MOV       ?V0,#0x0
   \   000068   801E         SJMP      ??AT_pwr_single_bus_send_buf_2
    100            {
   \                     ??AT_pwr_single_bus_send_buf_3:
   \   00006A                ; Setup parameters for call to function Onboard_wait
   \   00006A   7A5C         MOV       R2,#0x5c
   \   00006C   7B00         MOV       R3,#0x0
   \   00006E   12....       LCALL     `??Onboard_wait::?relay`; Banked call to: Onboard_wait
   \   000071   C2A0         CLR       0xa0.0
   \   000073                ; Setup parameters for call to function Onboard_wait
   \   000073   7ABF         MOV       R2,#-0x41
   \                     ??AT_pwr_single_bus_send_buf_4:
   \   000075   7B00         MOV       R3,#0x0
   \   000077   12....       LCALL     `??Onboard_wait::?relay`; Banked call to: Onboard_wait
   \   00007A   E5..         MOV       A,?V1
   \   00007C   C3           CLR       C
   \   00007D   13           RRC       A
   \   00007E   F5..         MOV       ?V1,A
   \   000080   15..         DEC       ?V2
   \   000082   E5..         MOV       A,?V2
   \   000084   7011         JNZ       ??AT_pwr_single_bus_send_buf_5
    101              AT_pwr_single_bus_send_byte(buf[i]);
   \   000086   05..         INC       ?V0
   \                     ??AT_pwr_single_bus_send_buf_2:
   \   000088   E5..         MOV       A,?V0
   \   00008A   C3           CLR       C
   \   00008B   95..         SUBB      A,?V3
   \   00008D   501D         JNC       ??AT_pwr_single_bus_send_buf_6
   \   00008F   12....       LCALL     ?Subroutine0 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   000092   F5..         MOV       ?V1,A
   \   000094   75..08       MOV       ?V2,#0x8
   \                     ??AT_pwr_single_bus_send_buf_5:
   \   000097   E5..         MOV       A,?V1
   \   000099   A2E0         MOV       C,0xE0 /* A   */.0
   \   00009B   D2A0         SETB      0xa0.0
   \   00009D   50CB         JNC       ??AT_pwr_single_bus_send_buf_3
   \   00009F                ; Setup parameters for call to function Onboard_wait
   \   00009F   7ABF         MOV       R2,#-0x41
   \   0000A1   7B00         MOV       R3,#0x0
   \   0000A3   12....       LCALL     `??Onboard_wait::?relay`; Banked call to: Onboard_wait
   \   0000A6   C2A0         CLR       0xa0.0
   \   0000A8                ; Setup parameters for call to function Onboard_wait
   \   0000A8   7A5C         MOV       R2,#0x5c
   \   0000AA   80C9         SJMP      ??AT_pwr_single_bus_send_buf_4
    102            }
    103          
    104            PWR_SINGLE_BUS_PIN = PWR_SINGLE_BUS_HIGH;
   \                     ??AT_pwr_single_bus_send_buf_6:
   \   0000AC   D2A0         SETB      0xa0.0
    105          
    106            AT_pwr_single_bus_input();
   \   0000AE                ; Setup parameters for call to function AT_pwr_single_bus_input
   \   0000AE   12....       LCALL     `??AT_pwr_single_bus_input::?relay`; Banked call to: AT_pwr_single_bus_input
    107          }
   \   0000B1   7F06         MOV       R7,#0x6
   \   0000B3   02....       LJMP      ?BANKED_LEAVE_XDATA
   \   0000B6                REQUIRE _A_P2
   \   0000B6                REQUIRE P2SEL
   \   0000B6                REQUIRE P2DIR
   \   0000B6                REQUIRE IEN2
   \   0000B6                REQUIRE P2IEN

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   A8..         MOV       R0,?V0
   \   000002   EE           MOV       A,R6
   \   000003   28           ADD       A,R0
   \   000004   F582         MOV       DPL,A
   \   000006   E4           CLR       A
   \   000007   3F           ADDC      A,R7
   \   000008   F583         MOV       DPH,A
   \   00000A   E0           MOVX      A,@DPTR
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    108          static void pwr_senddata(uint8* buf)
   \                     pwr_senddata:
    109          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000                REQUIRE ?V2
   \   000000                REQUIRE ?V3
   \   000000                REQUIRE ?V4
   \   000000                REQUIRE ?V5
   \   000000                REQUIRE ?V6
   \   000000                REQUIRE ?V7
   \   000000   74F0         MOV       A,#-0x10
   \   000002   12....       LCALL     ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 23
   \   000005   74E9         MOV       A,#-0x17
   \   000007   12....       LCALL     ?ALLOC_XSTACK8
    110            if(pwr_single_bus_rcv_len == 8)
   \   00000A   90....       MOV       DPTR,#pwr_single_bus_rcv_len
   \   00000D   E0           MOVX      A,@DPTR
   \   00000E   6408         XRL       A,#0x8
   \   000010   6003         JZ        $+5
   \   000012   02....       LJMP      ??pwr_senddata_0 & 0xFFFF
    111            {
    112              afAddrType_t dstAddr;
    113              dstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   000015   7413         MOV       A,#0x13
   \   000017   12....       LCALL     ?XSTACK_DISP0_8
   \   00001A   7402         MOV       A,#0x2
   \   00001C   F0           MOVX      @DPTR,A
    114              dstAddr.addr.shortAddr = NWK_PAN_COORD_ADDR;// default send to Coordinator
   \   00001D   740B         MOV       A,#0xb
   \   00001F   12....       LCALL     ?XSTACK_DISP0_8
   \   000022   E4           CLR       A
   \   000023   F0           MOVX      @DPTR,A
   \   000024   A3           INC       DPTR
   \   000025   F0           MOVX      @DPTR,A
    115              dstAddr.endPoint = 0x0B;//GENERIC_ENDPOINT on Coordinator
   \   000026   7414         MOV       A,#0x14
   \   000028   12....       LCALL     ?XSTACK_DISP0_8
   \   00002B   740B         MOV       A,#0xb
   \   00002D   F0           MOVX      @DPTR,A
    116          
    117              //build DoorLock Operation Event Notification
    118              zclDoorLockOperationEventNotification_t pPayload;
    119              pPayload.operationEventSource = 0xFE;
   \   00002E   85..82       MOV       DPL,?XSP + 0
   \   000031   85..83       MOV       DPH,?XSP + 1
   \   000034   74FE         MOV       A,#-0x2
   \   000036   12....       LCALL     ?Subroutine2 & 0xFFFF
    120              pPayload.operationEventCode = buf[0];
   \                     ??CrossCallReturnLabel_4:
   \   000039   E0           MOVX      A,@DPTR
   \   00003A   C0E0         PUSH      A
   \   00003C   7401         MOV       A,#0x1
   \   00003E   12....       LCALL     ?XSTACK_DISP0_8
   \   000041   D0E0         POP       A
   \   000043   12....       LCALL     ?Subroutine2 & 0xFFFF
    121              pPayload.userID = BUILD_UINT16(buf[1], buf[2]);
   \                     ??CrossCallReturnLabel_5:
   \   000046   A3           INC       DPTR
   \   000047   E0           MOVX      A,@DPTR
   \   000048   FC           MOV       R4,A
   \   000049   8A82         MOV       DPL,R2
   \   00004B   8B83         MOV       DPH,R3
   \   00004D   A3           INC       DPTR
   \   00004E   A3           INC       DPTR
   \   00004F   E0           MOVX      A,@DPTR
   \   000050   F9           MOV       R1,A
   \   000051   7402         MOV       A,#0x2
   \   000053   12....       LCALL     ?XSTACK_DISP0_8
   \   000056   EC           MOV       A,R4
   \   000057   F0           MOVX      @DPTR,A
   \   000058   A3           INC       DPTR
   \   000059   E9           MOV       A,R1
   \   00005A   12....       LCALL     ?Subroutine1 & 0xFFFF
    122              pPayload.pin = buf[3]; // it is battery level actually
   \                     ??CrossCallReturnLabel_2:
   \   00005D   E0           MOVX      A,@DPTR
   \   00005E   C0E0         PUSH      A
   \   000060   7404         MOV       A,#0x4
   \   000062   12....       LCALL     ?XSTACK_DISP0_8
   \   000065   D0E0         POP       A
   \   000067   12....       LCALL     ?Subroutine1 & 0xFFFF
    123              pPayload.zigBeeLocalTime = BUILD_UINT32(buf[4], buf[5], buf[6], buf[7]);
   \                     ??CrossCallReturnLabel_3:
   \   00006A   A3           INC       DPTR
   \   00006B   E0           MOVX      A,@DPTR
   \   00006C   F5..         MOV       ?V0,A
   \   00006E   E4           CLR       A
   \   00006F   F5..         MOV       ?V1,A
   \   000071   F5..         MOV       ?V2,A
   \   000073   F5..         MOV       ?V3,A
   \   000075   8A82         MOV       DPL,R2
   \   000077   8B83         MOV       DPH,R3
   \   000079   A3           INC       DPTR
   \   00007A   A3           INC       DPTR
   \   00007B   A3           INC       DPTR
   \   00007C   A3           INC       DPTR
   \   00007D   A3           INC       DPTR
   \   00007E   E0           MOVX      A,@DPTR
   \   00007F   F5..         MOV       ?V4,A
   \   000081   E4           CLR       A
   \   000082   F5..         MOV       ?V5,A
   \   000084   F5..         MOV       ?V6,A
   \   000086   F5..         MOV       ?V7,A
   \   000088   7408         MOV       A,#0x8
   \   00008A   78..         MOV       R0,#?V4
   \   00008C   12....       LCALL     ?L_SHL
   \   00008F   78..         MOV       R0,#?V0
   \   000091   79..         MOV       R1,#?V4
   \   000093   12....       LCALL     ?L_ADD
   \   000096   8A82         MOV       DPL,R2
   \   000098   8B83         MOV       DPH,R3
   \   00009A   A3           INC       DPTR
   \   00009B   A3           INC       DPTR
   \   00009C   A3           INC       DPTR
   \   00009D   A3           INC       DPTR
   \   00009E   A3           INC       DPTR
   \   00009F   A3           INC       DPTR
   \   0000A0   E0           MOVX      A,@DPTR
   \   0000A1   F5..         MOV       ?V4,A
   \   0000A3   E4           CLR       A
   \   0000A4   F5..         MOV       ?V5,A
   \   0000A6   7410         MOV       A,#0x10
   \   0000A8   78..         MOV       R0,#?V4
   \   0000AA   12....       LCALL     ?L_SHL
   \   0000AD   78..         MOV       R0,#?V0
   \   0000AF   79..         MOV       R1,#?V4
   \   0000B1   12....       LCALL     ?L_ADD
   \   0000B4   8A82         MOV       DPL,R2
   \   0000B6   8B83         MOV       DPH,R3
   \   0000B8   A3           INC       DPTR
   \   0000B9   A3           INC       DPTR
   \   0000BA   A3           INC       DPTR
   \   0000BB   A3           INC       DPTR
   \   0000BC   A3           INC       DPTR
   \   0000BD   A3           INC       DPTR
   \   0000BE   A3           INC       DPTR
   \   0000BF   E0           MOVX      A,@DPTR
   \   0000C0   F5..         MOV       ?V4,A
   \   0000C2   E4           CLR       A
   \   0000C3   F5..         MOV       ?V6,A
   \   0000C5   7418         MOV       A,#0x18
   \   0000C7   78..         MOV       R0,#?V4
   \   0000C9   12....       LCALL     ?L_SHL
   \   0000CC   78..         MOV       R0,#?V0
   \   0000CE   79..         MOV       R1,#?V4
   \   0000D0   12....       LCALL     ?L_ADD
   \   0000D3   7405         MOV       A,#0x5
   \   0000D5   12....       LCALL     ?XSTACK_DISP0_8
   \   0000D8   78..         MOV       R0,#?V0
   \   0000DA   12....       LCALL     ?L_MOV_TO_X
    124          
    125              pPayload.pData = (uint8 *)osal_mem_alloc(1);
   \   0000DD                ; Setup parameters for call to function osal_mem_alloc
   \   0000DD   7A01         MOV       R2,#0x1
   \   0000DF   7B00         MOV       R3,#0x0
   \   0000E1   12....       LCALL     `??osal_mem_alloc::?relay`; Banked call to: osal_mem_alloc
   \   0000E4   7409         MOV       A,#0x9
   \   0000E6   12....       LCALL     ?XSTACK_DISP0_8
   \   0000E9   EA           MOV       A,R2
   \   0000EA   F0           MOVX      @DPTR,A
   \   0000EB   A3           INC       DPTR
   \   0000EC   EB           MOV       A,R3
   \   0000ED   12....       LCALL     ?Subroutine2 & 0xFFFF
    126              pPayload.pData[0] = 0;
   \                     ??CrossCallReturnLabel_6:
   \   0000F0   E4           CLR       A
   \   0000F1   F0           MOVX      @DPTR,A
    127              /*pPayload.pData = (uint8 *)osal_mem_alloc(8);
    128              for(uint8 i=0;i!=8;++i){
    129                pPayload.pData[i]=buf[i];
    130              }*/
    131              zclClosures_SendDoorLockOperationEventNotification( DOORLOCK_ENDPOINT,//uint8 srcEP,
    132                                                                &dstAddr,//afAddrType_t *dstAddr,
    133                                                                &pPayload,//zclDoorLockOperationEventNotification_t *pPayload,
    134                                                                TRUE,//uint8 disableDefaultRsp,
    135                                                                ++bdb_ZclTransactionSequenceNumber);//uint8 seqNum
   \   0000F2   90....       MOV       DPTR,#bdb_ZclTransactionSequenceNumber
   \   0000F5   E0           MOVX      A,@DPTR
   \   0000F6   04           INC       A
   \   0000F7   F0           MOVX      @DPTR,A
   \   0000F8                ; Setup parameters for call to function zclClosures_SendDoorLockOperationEventNotification
   \   0000F8   F5..         MOV       ?V0,A
   \   0000FA   78..         MOV       R0,#?V0
   \   0000FC   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   0000FF   75..01       MOV       ?V0,#0x1
   \   000102   78..         MOV       R0,#?V0
   \   000104   12....       LCALL     ?PUSH_XSTACK_I_ONE
   \   000107   7402         MOV       A,#0x2
   \   000109   12....       LCALL     ?XSTACK_DISP102_8
   \   00010C   740D         MOV       A,#0xd
   \   00010E   12....       LCALL     ?XSTACK_DISP101_8
   \   000111   790A         MOV       R1,#0xa
   \   000113   12....       LCALL     ??zclClosures_SendDoorLockOperationEventNotific; Banked call to: zclClosures_SendDoorLockOperationEventNotification
   \   000116   7402         MOV       A,#0x2
   \   000118   12....       LCALL     ?DEALLOC_XSTACK8
    136          
    137            osal_mem_free( pPayload.pData );
   \   00011B                ; Setup parameters for call to function osal_mem_free
   \   00011B   7409         MOV       A,#0x9
   \   00011D   12....       LCALL     ?XSTACK_DISP0_8
   \   000120   E0           MOVX      A,@DPTR
   \   000121   FA           MOV       R2,A
   \   000122   A3           INC       DPTR
   \   000123   E0           MOVX      A,@DPTR
   \   000124   FB           MOV       R3,A
   \   000125   12....       LCALL     `??osal_mem_free::?relay`; Banked call to: osal_mem_free
    138            }
    139          }
   \                     ??pwr_senddata_0:
   \   000128   7417         MOV       A,#0x17
   \   00012A   12....       LCALL     ?DEALLOC_XSTACK8
   \   00012D   7F08         MOV       R7,#0x8
   \   00012F   02....       LJMP      ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   12....       LCALL     ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_7:
   \   000003   A3           INC       DPTR
   \   000004   A3           INC       DPTR
   \   000005   A3           INC       DPTR
   \   000006   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   F0           MOVX      @DPTR,A
   \   000001   8A82         MOV       DPL,R2
   \   000003   8B83         MOV       DPH,R3
   \   000005   22           RET

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
    140          HAL_ISR_FUNCTION( pwr_single_bus_Isr, P2INT_VECTOR )
   \                     pwr_single_bus_Isr:
    141          {
   \   000000                REQUIRE ?V0
   \   000000                REQUIRE ?V1
   \   000000   C0E0         PUSH      A
   \   000002   74F1         MOV       A,#-0xf
   \   000004   12....       LCALL     ?INTERRUPT_ENTER_XSP
   \   000007                ; Saved register size: 15
   \   000007                ; Auto size: 0
    142            HAL_ENTER_ISR();
   \   000007   A2AF         MOV       C,0xa8.7
   \   000009   E4           CLR       A
   \   00000A   33           RLC       A
   \   00000B   FE           MOV       R6,A
   \   00000C   D2AF         SETB      0xa8.7
    143          
    144            IEN2  &= ~BV(1); // disable port interrupt
   \   00000E   539AFD       ANL       0x9a,#0xfd
    145            P2IEN &= ~PWR_SINGLE_BUS_BV; // disable pin interrupt
   \   000011   53ACFE       ANL       0xac,#0xfe
    146          
    147            if(PWR_SINGLE_BUS_PIN)
   \   000014   A2A0         MOV       C,0xa0.0
   \   000016   5003         JNC       $+5
   \   000018   02....       LJMP      ??pwr_single_bus_Isr_0
    148            {
    149              goto pwr_isr_exit;
    150            }
    151          
    152            // start to capture the head (4 ms)
    153            AT_Timer4_Set_Clear_Start_US(0xFA);    //(250*7)*4=7000
   \   00001B                ; Setup parameters for call to function AT_Timer4_Set_Clear_Start_US
   \   00001B   79FA         MOV       R1,#-0x6
   \   00001D   12....       LCALL     `??AT_Timer4_Set_Clear_Start_US::?relay`; Banked call to: AT_Timer4_Set_Clear_Start_US
    154            while(1)
    155            {
    156          #ifdef WDT_IN_PM1
    157              WatchDogClear();
   \                     ??pwr_single_bus_Isr_1:
   \   000020   12....       LCALL     ?Subroutine3
    158          #endif
    159              if(T4IF)
   \                     ??CrossCallReturnLabel_8:
   \   000023   A2C4         MOV       C,0xc0.4
   \   000025   500D         JNC       ??pwr_single_bus_Isr_2
    160              {
    161                if(tim4_tick_peroid==7)    //overflow
   \   000027   90....       MOV       DPTR,#tim4_tick_peroid
   \   00002A   E0           MOVX      A,@DPTR
   \   00002B   6407         XRL       A,#0x7
   \   00002D   7003         JNZ       $+5
   \   00002F   02....       LJMP      ??pwr_single_bus_Isr_3
    162                {
    163                  T4IF = 0;
    164                  goto pwr_isr_exit;
    165                }
    166                T4IF = 0;
   \   000032   C2C4         CLR       0xc0.4
    167                
    168              }
    169              if(PWR_SINGLE_BUS_PIN)
   \                     ??pwr_single_bus_Isr_2:
   \   000034   A2A0         MOV       C,0xa0.0
   \   000036   50E8         JNC       ??pwr_single_bus_Isr_1
    170                break;
    171            }
    172            pwr_single_bus_rcv_low = AT_Timer4_Stop_Get()+tim4_tick_peroid*256;
   \   000038                ; Setup parameters for call to function AT_Timer4_Stop_Get
   \   000038   12....       LCALL     `??AT_Timer4_Stop_Get::?relay`; Banked call to: AT_Timer4_Stop_Get
   \   00003B   E9           MOV       A,R1
   \   00003C   FA           MOV       R2,A
   \   00003D   90....       MOV       DPTR,#tim4_tick_peroid
   \   000040   E0           MOVX      A,@DPTR
   \   000041   F8           MOV       R0,A
   \   000042   E4           CLR       A
   \   000043   C8           XCH       A,R0
   \   000044   F9           MOV       R1,A
   \   000045   EA           MOV       A,R2
   \   000046   28           ADD       A,R0
   \   000047   90....       MOV       DPTR,#pwr_single_bus_rcv_low
   \   00004A   F0           MOVX      @DPTR,A
   \   00004B   A3           INC       DPTR
   \   00004C   E9           MOV       A,R1
   \   00004D   F0           MOVX      @DPTR,A
    173            if(pwr_single_bus_rcv_low < 500)      //现在的每次计数相当于原来的4个计数
   \   00004E   90....       MOV       DPTR,#pwr_single_bus_rcv_low
   \   000051   E0           MOVX      A,@DPTR
   \   000052   94F4         SUBB      A,#-0xc
   \   000054   A3           INC       DPTR
   \   000055   E0           MOVX      A,@DPTR
   \   000056   9401         SUBB      A,#0x1
   \   000058   404C         JC        ??pwr_single_bus_Isr_0
    174            {
    175              goto pwr_isr_exit;
    176            }
    177          
    178            pwr_single_bus_rcv_len = 0;
   \   00005A   90....       MOV       DPTR,#pwr_single_bus_rcv_len
   \   00005D   E4           CLR       A
   \   00005E   F0           MOVX      @DPTR,A
    179            pwr_single_bus_rcv_bit = 0;
   \   00005F   90....       MOV       DPTR,#pwr_single_bus_rcv_bit
   \   000062   801C         SJMP      ??pwr_single_bus_Isr_4
    180          
    181            // start to capture data
    182            while(1)
    183            {
    184          #ifdef WDT_IN_PM1
    185              WatchDogClear();
    186          #endif
    187          
    188              // get high level time
    189              AT_Timer4_Set_Clear_Start_US(100);
    190              while(PWR_SINGLE_BUS_PIN)
    191              {
    192                if(T4IF)
    193                {
    194                  T4IF = 0;
    195          
    196                  if((pwr_single_bus_rcv_len > 0) && (pwr_single_bus_rcv_bit == 0))
    197                  {
    198                    pwr_senddata(pwr_single_bus_rcv_buf);
    199                    goto pwr_isr_exit;
    200                  }
    201          
    202                  goto pwr_isr_exit;
    203                }
    204              }
    205              pwr_single_bus_rcv_high = AT_Timer4_Stop_Get();
    206          
    207              // get low level time
    208              AT_Timer4_Set_Clear_Start_US(100);
    209              while(!PWR_SINGLE_BUS_PIN)
    210              {
    211                if(T4IF)
    212                {
    213                  T4IF = 0;
    214                  goto pwr_isr_exit;
    215                }
    216              }
    217              pwr_single_bus_rcv_low = AT_Timer4_Stop_Get();
    218          
    219              // check the total time
    220              pwr_single_bus_rcv_total = pwr_single_bus_rcv_high + pwr_single_bus_rcv_low;
    221              if ((pwr_single_bus_rcv_total < 30) || (pwr_single_bus_rcv_total > 87))
    222                goto pwr_isr_exit; // tolerance of 30%
    223          
    224              // save the data bit
    225              if(pwr_single_bus_rcv_high > pwr_single_bus_rcv_low)
    226                pwr_single_bus_rcv_buf[pwr_single_bus_rcv_len] |= BV(pwr_single_bus_rcv_bit++);
    227              else
    228                pwr_single_bus_rcv_buf[pwr_single_bus_rcv_len] &= ~BV(pwr_single_bus_rcv_bit++);
   \                     ??pwr_single_bus_Isr_5:
   \   000064   EC           MOV       A,R4
   \   000065   F4           CPL       A
   \   000066   FA           MOV       R2,A
   \   000067   8882         MOV       DPL,R0
   \   000069   8983         MOV       DPH,R1
   \   00006B   E0           MOVX      A,@DPTR
   \   00006C   5A           ANL       A,R2
   \                     ??pwr_single_bus_Isr_6:
   \   00006D   F0           MOVX      @DPTR,A
   \   00006E   90....       MOV       DPTR,#pwr_single_bus_rcv_bit
   \   000071   E0           MOVX      A,@DPTR
   \   000072   04           INC       A
   \   000073   F0           MOVX      @DPTR,A
    229          
    230              // increase the index
    231              if(pwr_single_bus_rcv_bit == 8) // get a whole byte (8 bits)
   \   000074   E0           MOVX      A,@DPTR
   \   000075   6408         XRL       A,#0x8
   \   000077   7008         JNZ       ??pwr_single_bus_Isr_7
    232              {
    233                pwr_single_bus_rcv_bit = 0;
   \   000079   E4           CLR       A
   \   00007A   F0           MOVX      @DPTR,A
    234                pwr_single_bus_rcv_len++;
   \   00007B   90....       MOV       DPTR,#pwr_single_bus_rcv_len
   \   00007E   E0           MOVX      A,@DPTR
   \   00007F   04           INC       A
   \                     ??pwr_single_bus_Isr_4:
   \   000080   F0           MOVX      @DPTR,A
    235              }
   \                     ??pwr_single_bus_Isr_7:
   \   000081   12....       LCALL     ?Subroutine3
   \                     ??CrossCallReturnLabel_9:
   \   000084                ; Setup parameters for call to function AT_Timer4_Set_Clear_Start_US
   \   000084   7964         MOV       R1,#0x64
   \   000086   12....       LCALL     `??AT_Timer4_Set_Clear_Start_US::?relay`; Banked call to: AT_Timer4_Set_Clear_Start_US
   \                     ??pwr_single_bus_Isr_8:
   \   000089   A2A0         MOV       C,0xa0.0
   \   00008B   5031         JNC       ??pwr_single_bus_Isr_9
   \   00008D   A2C4         MOV       C,0xc0.4
   \   00008F   50F8         JNC       ??pwr_single_bus_Isr_8
   \   000091   C2C4         CLR       0xc0.4
   \   000093   90....       MOV       DPTR,#pwr_single_bus_rcv_len
   \   000096   E0           MOVX      A,@DPTR
   \   000097   600D         JZ        ??pwr_single_bus_Isr_0
   \   000099   90....       MOV       DPTR,#pwr_single_bus_rcv_bit
   \   00009C   E0           MOVX      A,@DPTR
   \   00009D   7007         JNZ       ??pwr_single_bus_Isr_0
   \   00009F                ; Setup parameters for call to function pwr_senddata
   \   00009F   7A..         MOV       R2,#pwr_single_bus_rcv_buf & 0xff
   \   0000A1   7B..         MOV       R3,#(pwr_single_bus_rcv_buf >> 8) & 0xff
   \   0000A3   12....       LCALL     `??pwr_senddata::?relay`; Banked call to: pwr_senddata
    236            }
    237          
    238          pwr_isr_exit:
    239          
    240            IEN2  |= BV(1); // enable port interrupt
   \                     ??pwr_single_bus_Isr_0:
   \   0000A6   439A02       ORL       0x9a,#0x2
    241            P2IEN |= PWR_SINGLE_BUS_BV; // enable pin interrupt
   \   0000A9   43AC01       ORL       0xac,#0x1
    242          
    243            P2IFG = 0x00;
   \   0000AC   758B00       MOV       0x8b,#0x0
    244            P2IF = 0x00;
   \   0000AF   C2E8         CLR       0xe8.0
    245          
    246            CLEAR_SLEEP_MODE();
   \   0000B1   75..00       MOV       halSleepPconValue,#0x0
    247            HAL_EXIT_ISR();
   \   0000B4   EE           MOV       A,R6
   \   0000B5   A2E0         MOV       C,0xE0 /* A   */.0
   \   0000B7   92AF         MOV       0xa8.7,C
    248          }
   \   0000B9   7F02         MOV       R7,#0x2
   \   0000BB   02....       LJMP      ?INTERRUPT_LEAVE_XSP
   \                     ??pwr_single_bus_Isr_9:
   \   0000BE                ; Setup parameters for call to function AT_Timer4_Stop_Get
   \   0000BE   12....       LCALL     `??AT_Timer4_Stop_Get::?relay`; Banked call to: AT_Timer4_Stop_Get
   \   0000C1   E9           MOV       A,R1
   \   0000C2   90....       MOV       DPTR,#pwr_single_bus_rcv_high
   \   0000C5   F0           MOVX      @DPTR,A
   \   0000C6   A3           INC       DPTR
   \   0000C7   E4           CLR       A
   \   0000C8   F0           MOVX      @DPTR,A
   \   0000C9                ; Setup parameters for call to function AT_Timer4_Set_Clear_Start_US
   \   0000C9   7964         MOV       R1,#0x64
   \   0000CB   12....       LCALL     `??AT_Timer4_Set_Clear_Start_US::?relay`; Banked call to: AT_Timer4_Set_Clear_Start_US
   \                     ??pwr_single_bus_Isr_10:
   \   0000CE   A2A0         MOV       C,0xa0.0
   \   0000D0   4008         JC        ??pwr_single_bus_Isr_11
   \   0000D2   A2C4         MOV       C,0xc0.4
   \   0000D4   50F8         JNC       ??pwr_single_bus_Isr_10
   \                     ??pwr_single_bus_Isr_3:
   \   0000D6   C2C4         CLR       0xc0.4
   \   0000D8   80CC         SJMP      ??pwr_single_bus_Isr_0
   \                     ??pwr_single_bus_Isr_11:
   \   0000DA                ; Setup parameters for call to function AT_Timer4_Stop_Get
   \   0000DA   12....       LCALL     `??AT_Timer4_Stop_Get::?relay`; Banked call to: AT_Timer4_Stop_Get
   \   0000DD   E9           MOV       A,R1
   \   0000DE   90....       MOV       DPTR,#pwr_single_bus_rcv_low
   \   0000E1   F0           MOVX      @DPTR,A
   \   0000E2   A3           INC       DPTR
   \   0000E3   E4           CLR       A
   \   0000E4   F0           MOVX      @DPTR,A
   \   0000E5   90....       MOV       DPTR,#pwr_single_bus_rcv_high
   \   0000E8   E0           MOVX      A,@DPTR
   \   0000E9   F8           MOV       R0,A
   \   0000EA   A3           INC       DPTR
   \   0000EB   E0           MOVX      A,@DPTR
   \   0000EC   F9           MOV       R1,A
   \   0000ED   90....       MOV       DPTR,#pwr_single_bus_rcv_low
   \   0000F0   E0           MOVX      A,@DPTR
   \   0000F1   28           ADD       A,R0
   \   0000F2   F8           MOV       R0,A
   \   0000F3   E4           CLR       A
   \   0000F4   39           ADDC      A,R1
   \   0000F5   F9           MOV       R1,A
   \   0000F6   90....       MOV       DPTR,#pwr_single_bus_rcv_total
   \   0000F9   E8           MOV       A,R0
   \   0000FA   F0           MOVX      @DPTR,A
   \   0000FB   A3           INC       DPTR
   \   0000FC   E9           MOV       A,R1
   \   0000FD   F0           MOVX      @DPTR,A
   \   0000FE   90....       MOV       DPTR,#pwr_single_bus_rcv_total
   \   000101   E0           MOVX      A,@DPTR
   \   000102   24E2         ADD       A,#-0x1e
   \   000104   F8           MOV       R0,A
   \   000105   A3           INC       DPTR
   \   000106   E0           MOVX      A,@DPTR
   \   000107   34FF         ADDC      A,#-0x1
   \   000109   F9           MOV       R1,A
   \   00010A   C3           CLR       C
   \   00010B   E8           MOV       A,R0
   \   00010C   943A         SUBB      A,#0x3a
   \   00010E   E9           MOV       A,R1
   \   00010F   9400         SUBB      A,#0x0
   \   000111   5093         JNC       ??pwr_single_bus_Isr_0
   \   000113   75..01       MOV       ?V0,#0x1
   \   000116   75..00       MOV       ?V1,#0x0
   \   000119   90....       MOV       DPTR,#pwr_single_bus_rcv_bit
   \   00011C   E0           MOVX      A,@DPTR
   \   00011D   78..         MOV       R0,#?V0
   \   00011F   12....       LCALL     ?S_SHL
   \   000122   E5..         MOV       A,?V0
   \   000124   FC           MOV       R4,A
   \   000125   90....       MOV       DPTR,#pwr_single_bus_rcv_len
   \   000128   E0           MOVX      A,@DPTR
   \   000129   F8           MOV       R0,A
   \   00012A   74..         MOV       A,#pwr_single_bus_rcv_buf & 0xff
   \   00012C   28           ADD       A,R0
   \   00012D   F8           MOV       R0,A
   \   00012E   E4           CLR       A
   \   00012F   34..         ADDC      A,#(pwr_single_bus_rcv_buf >> 8) & 0xff
   \   000131   F9           MOV       R1,A
   \   000132   90....       MOV       DPTR,#pwr_single_bus_rcv_low
   \   000135   C082         PUSH      DPL
   \   000137   90....       MOV       DPTR,#pwr_single_bus_rcv_high
   \   00013A   E0           MOVX      A,@DPTR
   \   00013B   FA           MOV       R2,A
   \   00013C   A3           INC       DPTR
   \   00013D   E0           MOVX      A,@DPTR
   \   00013E   FB           MOV       R3,A
   \   00013F   7583..       MOV       DPH,#(pwr_single_bus_rcv_low >> 8) & 0xff
   \   000142   D082         POP       DPL
   \   000144   C3           CLR       C
   \   000145   E0           MOVX      A,@DPTR
   \   000146   9A           SUBB      A,R2
   \   000147   A3           INC       DPTR
   \   000148   E0           MOVX      A,@DPTR
   \   000149   9B           SUBB      A,R3
   \   00014A   4003         JC        $+5
   \   00014C   02....       LJMP      ??pwr_single_bus_Isr_5
   \   00014F   8882         MOV       DPL,R0
   \   000151   8983         MOV       DPH,R1
   \   000153   E0           MOVX      A,@DPTR
   \   000154   4C           ORL       A,R4
   \   000155   02....       LJMP      ??pwr_single_bus_Isr_6
   \   000158                REQUIRE _A_IEN0
   \   000158                REQUIRE IEN2
   \   000158                REQUIRE P2IEN
   \   000158                REQUIRE _A_P2
   \   000158                REQUIRE WDCTL
   \   000158                REQUIRE _A_IRCON
   \   000158                REQUIRE P2IFG
   \   000158                REQUIRE _A_IRCON2

   \                                 In  segment NEAR_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   E5C9         MOV       A,0xc9
   \   000002   540F         ANL       A,#0xf
   \   000004   44A0         ORL       A,#0xa0
   \   000006   F5C9         MOV       0xc9,A
   \   000008   E5C9         MOV       A,0xc9
   \   00000A   540F         ANL       A,#0xf
   \   00000C   4450         ORL       A,#0x50
   \   00000E   F5C9         MOV       0xc9,A
   \   000010   22           RET

   \                                 In  segment INTVEC, offset 0x33, root
   \                     `??pwr_single_bus_Isr::??INTVEC 51`:
   \   000033   02....       LJMP       (pwr_single_bus_Isr)

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "|down|-----|%02d byte...">`:
   \   000000   7C646F77     DB "|down|-----|%02d bytes|: "
   \            6E7C2D2D
   \            2D2D2D7C
   \            25303264
   \            20627974
   \            65737C3A
   \            2000    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "%02X ">`:
   \   000000   25303258     DB "%02X "
   \            2000    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "\\r\\n">`:
   \   000000   0D0A00       DB "\015\012"

   Maximum stack usage in bytes:

   ISTACK XSTACK Function
   ------ ------ --------
      2      0   AT_pwr_single_bus_init
        2      0   -> AT_pwr_single_bus_input
      0     14   AT_pwr_single_bus_input
      0     16   AT_pwr_single_bus_send_buf
        0     14   -> AT_pwr_single_bus_input
        0     14   -> Onboard_wait
        0     14   -> printf
        0     16   -> printf
      1     56   pwr_senddata
        0     39   -> osal_mem_alloc
        0     39   -> osal_mem_free
        0     41   -> zclClosures_SendDoorLockOperationEventNotification
      2     15   pwr_single_bus_Isr
        0     15   -> AT_Timer4_Set_Clear_Start_US
        0     15   -> AT_Timer4_Stop_Get
        0     15   -> pwr_senddata


   Segment part sizes:

   Bytes  Function/Label
   -----  --------------
       6  ?<Constant "%02X ">
       3  ?<Constant "\r\n">
      26  ?<Constant "|down|-----|%02d byte...">
      12  ?Subroutine0
       7  ?Subroutine1
       6  ?Subroutine2
      17  ?Subroutine3
      20  AT_pwr_single_bus_init
      29  AT_pwr_single_bus_input
     182  AT_pwr_single_bus_send_buf
       1  IEN2
       1  IP0
       1  IP1
       1  P2DIR
       1  P2IEN
       1  P2IFG
       1  P2INP
       1  P2SEL
       1  PICTL
       1  WDCTL
       1  _A_IEN0
       1  _A_IRCON
       1  _A_IRCON2
       1  _A_P2
     306  pwr_senddata
     344  pwr_single_bus_Isr
       3  pwr_single_bus_Isr::??INTVEC 51
       1  pwr_single_bus_rcv_bit
      10  pwr_single_bus_rcv_buf
       2  pwr_single_bus_rcv_high
       1  pwr_single_bus_rcv_len
       2  pwr_single_bus_rcv_low
       2  pwr_single_bus_rcv_total
      24  -- Other

 
 562 bytes in segment BANKED_CODE
  24 bytes in segment BANK_RELAYS
   3 bytes in segment INTVEC
 361 bytes in segment NEAR_CODE
  14 bytes in segment SFR_AN
  35 bytes in segment XDATA_ROM_C
  18 bytes in segment XDATA_Z
 
 385 bytes of CODE     memory (+  3 bytes shared)
  35 bytes of CONST    memory
   0 bytes of DATA     memory (+ 14 bytes shared)
 562 bytes of HUGECODE memory
  18 bytes of XDATA    memory

Errors: none
Warnings: none
